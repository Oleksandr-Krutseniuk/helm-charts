commonAnnotations:
  argocd.argoproj.io/sync-wave: "-5"
  #autoscaler.kubernetes.io/safe-to-evict: "false"

architecture: replication
auth:
  enabled: false
  sentinel: false
commonConfiguration: |-
  # Enable AOF https://redis.io/topics/persistence#append-only-file
  appendonly no
  # Disable RDB persistence, AOF persistence already enabled.
  save ""
  maxmemory-policy volatile-lru
  maxmemory 1Gi
  databases 48

master:
  tolerations:
  - key: dedicated
    operator: Equal
    value: backend
    effect: NoSchedule
  persistence:
    enabled: true
  nodeSelector:
    role: redis
replica:
  tolerations:
  - key: dedicated
    operator: Equal
    value: backend
    effect: NoSchedule
  replicaCount: 2
  priorityClassName: system-node-critical
  persistence:
    enabled: true
  nodeSelector:
    role: redis

sentinel:
  image:
    repository: "bitnami/redis-sentinel"
  enabled: true
  persistence:
    enabled: true

metrics:
  enabled: true
  prometheusRule:
    enabled: true

    rules:
      - alert: RedisDown
        expr: redis_up{service="redis-metrics"} == 0
        for: 5m
        labels:
          severity: error
        annotations:
          summary: "Redis instance down"
          description: "Redis instance down"
